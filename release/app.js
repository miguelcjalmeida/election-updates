(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";var SetStateVotes=null;(function(){var votesByStateCache={};init();SetStateVotes=setStateVotes;function init(){var $states=document.querySelectorAll(".fKE5Bb");var hasNewVotes=false;$states.forEach(function($state){return initState($state)});keepCheckingChanges();function initState($state){var stateName=getStateName($state);votesByStateCache[stateName]=[0,0]}function checkStateVoteChanges($state){if(didAnyVoteHappenForState($state)){console.log(getStateVoteUpdateMessage($state));votesByStateCache[getStateName($state)]=getStateVotes($state);hasNewVotes=true}}function checkChanges(){$states=document.querySelectorAll(".fKE5Bb");$states.forEach(function($state){return checkStateVoteChanges($state)});if(hasNewVotes){playNotificationSound();hasNewVotes=false}}function keepCheckingChanges(){var repetition=function(){console.log("checking for new votes..");checkChanges()};repetition();setInterval(repetition,6e4)}}function playNotificationSound(){var sound=new Audio("https://freesound.org/data/previews/320/320654_5260872-lq.ogg");sound.play()}function getStateVoteUpdateMessage($state){var biden="Biden";var trump="Trump";var stateName=getStateName($state);var currentVotes=getStateVotes($state);var cachedVotes=votesByStateCache[stateName];var votesDiff=Math.abs(currentVotes[0]-currentVotes[1]);var isBidenWinning=currentVotes[0]>=currentVotes[1];var losingCandidate=isBidenWinning?trump:biden;var bidenNewVotes=currentVotes[0]-cachedVotes[0];var trumpNewVotes=currentVotes[1]-cachedVotes[1];var totalNewVotes=bidenNewVotes+trumpNewVotes;var trumpPercNewVotes=trumpNewVotes/totalNewVotes;var bidenPercNewVotes=bidenNewVotes/totalNewVotes;var loserDiffPercNewVote=isBidenWinning?trumpPercNewVotes-bidenPercNewVotes:bidenPercNewVotes-trumpPercNewVotes;var projectionInFloat=votesDiff/loserDiffPercNewVote;var projection=Math.round(projectionInFloat);var isProjectionVisible=isBidenWinning&&trumpNewVotes>bidenNewVotes||!isBidenWinning&&bidenNewVotes>trumpNewVotes;var reportedVotesPerc=getStateReportedVotesPercentage($state);var unreportedVotesPerc=100-reportedVotesPerc;var allPartiesVotes=getAllPartiesVotesOfState($state);var estimatedMissingVotes=Math.round(allPartiesVotes-allPartiesVotes*reportedVotesPerc/100);var line1=stateName+" got new votes!";var line2=buildVoteLine(biden,cachedVotes[0],currentVotes[0]);var line3=buildVoteLine(trump,cachedVotes[1],currentVotes[1]);var line4=losingCandidate+" needs "+f(votesDiff)+" votes";var line5=stateName+" has yet to report up to "+f(estimatedMissingVotes)+" ("+f(unreportedVotesPerc)+"%) votes.";var line5Addendum="So far "+f(allPartiesVotes)+" ("+f(reportedVotesPerc)+"%) votes were counted";var line6=isProjectionVisible?"By projection, "+losingCandidate+" could be winning after "+f(projection)+" more votes counted":"";var line7=votesDiff>estimatedMissingVotes?"DONE! Race is over in the state of "+stateName+"\nBecause "+losingCandidate+" would need more votes than the amount left to count!":"";return line1+"\n"+line2+"\n"+line3+"\n"+line4+"\n"+line5+" "+line5Addendum+"\n"+line6+"\n"+line7;function buildVoteLine(candidate,oldVote,currentVote){var oldVoteFormatted=f(oldVote);var currentVoteFormatted=f(currentVote);var diffPrefix=currentVote>oldVote?"+":"";var diffFormatted=""+diffPrefix+f(currentVote-oldVote);return candidate+": "+oldVoteFormatted+" -> "+currentVoteFormatted+" ("+diffFormatted+")"}}function f(number){return number.toLocaleString()}function didAnyVoteHappenForState($state){var stateName=getStateName($state);var currentVotes=getStateVotes($state);var cacheVotes=votesByStateCache[stateName];return!areVotesEqual(currentVotes,cacheVotes)}function areVotesEqual($votes1,$votes2){return $votes1[0]==$votes2[0]&&$votes1[1]===$votes2[1]}function getStateName($state){return $state.querySelector(":scope > div > span").textContent}function getStateVotes($state){return[getBidenVotes($state),getTrumpVotes($state)]}function getStateReportedVotesPercentage($state){return $state.querySelector(".E2WDKf").textContent.match(/(\d+)%/)[1]}function getAllPartiesVotesOfState($state){var $votes=$state.querySelectorAll(":scope > div")[1];var $biden=$votes.querySelectorAll(":scope > div")[0];var $trump=$votes.querySelectorAll(":scope > div")[1];var bidenVotes=getSectionVotes($biden);var trumpVotes=getSectionVotes($trump);var bidenVotesPerc=getSectionVotesPerc($biden);var trumpVotesPerc=getSectionVotesPerc($trump);var bothVotesPerc=bidenVotesPerc+trumpVotesPerc;var bothVotes=bidenVotes+trumpVotes;return Math.round(bothVotes*100/bothVotesPerc)}function getBidenVotes($state){var $votes=$state.querySelectorAll(":scope > div")[1];var $biden=$votes.querySelectorAll(":scope > div")[0];return getSectionVotes($biden)}function getTrumpVotes($state){var $votes=$state.querySelectorAll(":scope > div")[1];var $trump=$votes.querySelectorAll(":scope > div")[1];return getSectionVotes($trump)}function getSectionVotes($voteSection){return parseInt($voteSection.querySelectorAll(":scope > span")[1].textContent.replace(/[\.\,]/g,""),10)}function getSectionVotesPerc($voteSection){return parseFloat($voteSection.querySelectorAll(":scope > span")[0].textContent.replace(/[\.\,]/g,".").replace("%",""))}function getState($name){return document.evaluate('//span[text()="'+$name+'"]',document,null,XPathResult.ANY_TYPE,null).iterateNext().parentNode.parentNode}function setStateVotes(name,vote1,vote2){var $state=getState(name);var $votes=$state.querySelectorAll(":scope > div")[1];var $biden=$votes.querySelectorAll(":scope > div")[0];var $trump=$votes.querySelectorAll(":scope > div")[1];$biden.querySelectorAll(":scope > span")[1].textContent=vote1;$trump.querySelectorAll(":scope > span")[1].textContent=vote2}})()},{}]},{},[1]);
